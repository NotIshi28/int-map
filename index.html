<html><head>
    <title>Interactive Global Population Visualization with Framed Flags</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        #globe {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            pointer-events: none;
            display: none;
        }
        #instructions {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
        }
        #population-display {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
            font-size: 18px;
        }
        #flag-display {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        #flag-frame {
            width: 160px;
            height: 100px;
            border: 5px solid #4B5358;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #2B3034;
        }
        #flag-frame img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
    </style>
    </head>
    <body>
    <div id="globe"></div>
    <div id="tooltip"></div>
    <div id="instructions">
        Use arrow keys to rotate the globe:<br>
        ← → : Rotate horizontally<br>
        ↑ ↓ : Rotate vertically<br>
        Click on a country to highlight it<br>
        Hover over a country to see its flag
    </div>
    <div id="population-display"></div>
    <div id="flag-display">
        <div id="flag-frame">
            <img id="flag-img" src="" alt="Country flag">
        </div>
    </div>
    <script>
        const width = window.innerWidth;
        const height = window.innerHeight;
        const sensitivity = 75;
    
        const projection = d3.geoOrthographic()
            .scale(Math.min(width, height) / 2.5)
            .center([0, 0])
            .rotate([0, -30])
            .translate([width / 2, height / 2]);
    
        const canvas = d3.select('#globe')
            .append('canvas')
            .attr('width', width)
            .attr('height', height);
    
        const context = canvas.node().getContext('2d');
    </script>
    </body>
    </html>